{% extends "base.html" %}
{% block content %}
<h1>Seu carrinho</h1>

{% if carrinho %}
<form action="{{ url_for('atualizar') }}" method="post">
  <table class="cart">
    <thead>
      <tr>
        <th>Produto</th>
        <th>Preço</th>
        <th>Qtd</th>
        <th>Subtotal</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for key, item in carrinho.items() %}
      <tr>
        <td>{{ item.nome }}</td>
        <td>R$ {{ "%.2f"|format(item.preco|float) }}</td>
        <td>
          <input type="number" name="qty_{{ key }}" value="{{ item.qty }}" min="0">
        </td>
        <td>R$ {{ "%.2f"|format((item.preco|float) * item.qty) }}</td>
        <td>
          <form action="{{ url_for('remover', produto_id=item.id) }}" method="post">
            <button class="btn btn-danger" type="submit">Remover</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="cart-total">
    <strong>Total:</strong> R$ {{ "%.2f"|format(total) }}
  </div>
  <div class="cart-actions">
    <button class="btn" type="submit">Atualizar carrinho</button>
    <a class="btn btn-primary" href="{{ url_for('checkout') }}">Ir para checkout</a>
  </div>
</form>
{% else %}
<p>Seu carrinho está vazio.</p>
<a class="btn" href="{{ url_for('index') }}">Voltar às compras</a>
{% endif %}
{% endblock %}